(function($){window.gc_search_config={mainSearchInputSelector:'body.search main form[role="search"] input[type="search"]',otherSearchInputSelector:'.c-drawer__search input[name="s"][type="search"]',facetInputSelector:'input[name="s"][type="search"]',resultsContainerSelector:'article > div.c-search-results',autocompleteContainerSelector:'.c-drawer__search form[role="search"].search-form',filters:{}};var gcSearchAutocompleteResultRender=function(ctx,results,term){var $list=ctx.list;var config=ctx.config;$.each(results,function(document_type,items){var localCount=0;var otherCount=0;var localContainer=$('<ul class="c-suggestions__list u-spacing--quarter" data-context="search-local-suggestions"></ul>');var otherContainer=$('<ul class="c-suggestions__list u-spacing--quarter" data-context="search-other-suggestions"></ul>');$.each(items,function(idx,item){var item_url=window.URL&&new window.URL(item['url']);var itemLink=$(config.renderFunction(document_type,item,idx,term));if(item_url&&item_url.hostname===location.hostname){localCount+=1;itemLink.appendTo(localContainer);}else{otherCount+=1;itemLink.appendTo(otherContainer);}
ctx.registerResult(itemLink,item);});if(localCount>0){var container=$('<div class="c-suggestions__main u-spacing--quarter">'+
'<h4 class="c-suggestions__heading u-font--secondary--xs u-text-transform--upper u-color--gray can-be--lighter">'+
window.gc_search_settings.this_site_text+' ('+localCount+')'+
'</h4>'+
'</div>');localContainer.appendTo(container);container.appendTo($list);}
if(otherCount>0){var container=$('<div class="c-suggestions__other u-spacing--quarter">'+
'<h4 class="c-suggestions__heading u-font--secondary--xs u-text-transform--upper u-color--gray can-be--lighter">'+
window.gc_search_settings.other_sites_text+' ('+otherCount+')'+
'</h4>'+
'</div>');otherContainer.appendTo(container);container.appendTo($list);}});};var gcSearchAddTags=function(item,term){var item_url=window.URL&&new window.URL(item['url']);if(item_url){item_url.searchParams.set('searchsite',location.hostname);item_url.searchParams.set('ref','on-site-search');item_url.searchParams.set('searchterm',term);item['url']=item_url.href;}}
var gcSearchAutocompleteRender=function(document_type,item,idx,term){var display=item['highlight']['title']||Swiftype.htmlEscape(item['title']);display=display.replace(/<(\/?)em>/g,'<$1mark>');gcSearchAddTags(item,term);return ''+
'<li>'+
'<a href="'+item['url']+'" class="u-theme--color--darker can-be--white">'+
display+
'</a>'+
'</li>';}
var gcSearchRender=function(document_type,item){var term=$(window.gc_search_config.mainSearchInputSelector).val();var html_title=((item['highlight']['title']&&item['highlight']['title'].replace(/<(\/?)em>/g,'<$1mark>'))||Swiftype.htmlEscape(item['title']));var description=((item['highlight']['description']&&item['highlight']['description'].replace(/<(\/?)em>/g,'<$1mark>'))||(item['highlight']['body']&&item['highlight']['body'].replace(/<(\/?)em>/g,'<$1mark>'))||(item['description']&&Swiftype.htmlEscape(item['description']))||Swiftype.htmlEscape(item['body'])).replace(/^(.{210}[^\s]*).*/us,"$1");var url=item['site'];if(url&&!url.match(/^https?:\/\//))url='https://'+url;if(!url)url=item['url'];var source='';if(url)source=new URL(url).hostname;if(source==location.hostname)source=window.gc_search_settings.this_site_text;if(source!=''){source=''+
'<div class="c-block__meta u-theme--color--dark">'+
'<span class="c-block__meta u-font--secondary--xs">'+
source+
'</span>'+
'</div>';}
gcSearchAddTags(item,term);return ''+
'<div class="c-media-block c-block c-block__row c-block--search l-grid-wrap u-border-left--black--at-small">'+
'<div class="c-block__content u-spacing l-grid-item l-grid-item--4-col l-grid-item--m--4-col u-color--gray u-font--secondary">'+
'<div class="u-spacing c-block__group">'+
'<div class="u-width--100p u-spacing">'+
'<h3 class="c-block__title u-theme--color--darker u-font--primary--m">'+
'<a href="'+item['url']+'" class="c-block__title-link u-theme--link-hover--dark">'+
html_title+
'</a>'+
'</h3>'+
'<p class="c-block__description">'+
description+
'</p>'+
'</div>'+
source+
'</div>'+
'</div>'+
'</div>';}
var gcSearchUpdateUrl=function(){var url=new URL(window.location.toString());var s_value=$(window.gc_search_config.mainSearchInputSelector)[0].value
if((url.searchParams.get('s')!=s_value)&&window.history.pushState){url.searchParams.set('s',s_value);window.history.replaceState({path:url.href},'',url.href);}}
var gcSearchUpdateFilters=function(event){$('input[type="radio"][name="search_scope"][value="'+this.value+'"]').attr('checked','checked');var new_url=new URL(window.location);if(this.value=='this_site'){if($.isEmptyObject(window.gc_search_config.filters)){window.gc_search_config.filters={page:{site:window.location.hostname}};if(Swiftype.reloadResults)Swiftype.reloadResults();if(Swiftype.resetAutocompleteCache)Swiftype.resetAutocompleteCache();}
new_url.searchParams.set('search_scope','this_site');}else{if(!$.isEmptyObject(window.gc_search_config.filters)){window.gc_search_config.filters={};if(Swiftype.reloadResults)Swiftype.reloadResults();if(Swiftype.resetAutocompleteCache)Swiftype.resetAutocompleteCache();}
new_url.searchParams.set('search_scope','all_sites');}
window.history.replaceState({path:new_url.href},'',new_url.href);var input=$(this).parents('form').find(window.gc_search_config.facetInputSelector)[0];input.focus();};var gcSearchGetFilters=function(){return window.gc_search_config.filters;};var handleSearchFormSubmit=function(){var new_action_url=new URL(this.action);var s_value=$(this).find('input[name="s"]')[0].value;new_action_url.hash='#stq='+encodeURIComponent(s_value)+'&stp=1';this.action=new_action_url.href;};var queryParam=function(param){return new URL(window.location).searchParams.get(param);};var gcSearchPaginator=function(type,currentPage,totalPages){var previousPage,nextPage,pages='<nav class="pagination u-space--double--top can-be--dark" role="navigation">';if(currentPage!=1){previousPage=currentPage-1;pages=pages+
'<a href="#" rel="noindex, follow" class="pagination__page pagination__prev u-theme--color--darker" data-hash="true" data-page="'+previousPage+'">'+
'<span class="u-icon u-icon--m u-theme--path-fill--dark">'+
'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10">'+
'<title>'+window.gc_search_settings.previous_page_text+'</title>'+
'<path d="M3.25,6.41l3.5,3.5L8.16,8.5,4.66,5l3.5-3.5L6.75.09l-3.5,3.5L1.84,5Z" fill="#9b9b9b"></path>'+
'</svg>'+
'</span>'+
'</a>';}
if(currentPage>4){pages=pages+'<a href="#" rel="noindex, follow" class="pagination__page u-theme--color--darker" data-hash="true" data-page="1">1</a>';if(currentPage>5)pages=pages+'<span class="pagination__divide">…</span>';}
for(var i=-3;i<=3;i++){if(currentPage+i<1||currentPage+i>totalPages)continue;if(i==0){pages=pages+'<span class="pagination__page pagination__page--current u-theme--color--base">'+currentPage+'</span>';}else{pages=pages+'<a href="#" rel="noindex, follow" class="pagination__page u-theme--color--darker" data-hash="true" data-page="'+(currentPage+i)+'">'+(currentPage+i)+'</a>';}}
if(currentPage+3<totalPages){if(currentPage+4<totalPages)pages=pages+'<span class="pagination__divide">…</span>';pages=pages+'<a href="#" rel="noindex, follow" class="pagination__page u-theme--color--darker" data-hash="true" data-page="'+totalPages+'">'+totalPages+'</a>';}
if(currentPage<totalPages){nextPage=currentPage+1;pages=pages+
'<a href="#" rel="noindex, follow" class="pagination__page pagination__next u-theme--color--darker" data-hash="true" data-page="'+nextPage+'">'+
'<span class="u-icon u-icon--m u-theme--path-fill--dark">'+
'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 10">'+
'<title>'+window.gc_search_settings.next_page_text+'</title>'+
'<path d="M6.75,3.59,3.25.09,1.84,1.5,5.34,5,1.84,8.5,3.25,9.91l3.5-3.5L8.16,5Z" fill="#9b9b9b"></path>'+
'</svg>'+
'</span>'+
'</a>';}
pages+='</nav>';return pages;}
$(function(){var search_fields=$(window.gc_search_config.otherSearchInputSelector);search_fields.val('');var search_form=search_fields.parents('form');search_form.on('submit',handleSearchFormSubmit);if(window.gc_search_settings.facet_for_this_site_only){if(queryParam('search_scope')=='this_site')window.gc_search_config.filters={page:{site:window.location.hostname}};var facet=''+
'<div class="c-filter__form-item u-spacing--half u-padding--top">'+
'<h3 class="u-font--secondary--s u-font-weight--bold u-text-transform--upper u-theme--color--base">'+
window.gc_search_settings.filter_text+
'</h3>'+
'<div class="c-filter__form-group">'+
'<label>'+
'<input type="radio" name="search_scope" value="this_site" '+(queryParam('search_scope')=='this_site'?'checked':'')+' />'+
window.gc_search_settings.this_site_only_text+
'</label>'+
'</div>'+
'<div class="c-filter__form-group">'+
'<label>'+
'<input type="radio" name="search_scope" value="all_sites" '+(queryParam('search_scope')!='this_site'?'checked':'')+' />'+
window.gc_search_settings.multiple_sites_text+
'</label>'+
'</div>'+
'</div>';$(window.gc_search_config.facetInputSelector).after(facet);$('input[type="radio"][name="search_scope"]').on('change',gcSearchUpdateFilters);}
search_fields.swiftype({engineKey:window.gc_search_settings.search_engine_key,autocompleteContainingElement:window.gc_search_config.autocompleteContainerSelector,dropdownStylesFunction:function(){return{};},suggestionListType:'div',suggestionListClass:'c-suggestions u-border--bottom u-theme--border-color--darker--bottom u-spacing can-be--dark u-padding--bottom',resultRenderFunction:gcSearchAutocompleteResultRender,renderFunction:gcSearchAutocompleteRender,filters:gcSearchGetFilters});$(window.gc_search_config.mainSearchInputSelector).swiftypeSearch({engineKey:window.gc_search_settings.search_engine_key,renderFunction:gcSearchRender,resultContainingElement:window.gc_search_config.resultsContainerSelector,postRenderFunction:gcSearchUpdateUrl,renderPaginationForType:gcSearchPaginator,fetchFields:{'page':['url','title','description','body','image','site']},filters:gcSearchGetFilters});$(window.gc_search_config.resultsContainerSelector).empty();$('body.search-no-results').removeClass('search-no-results');$("nav.c-secondary-nav a[href='#']").click(function(e){e.preventDefault();});});})(jQuery);(function($){var queryParser=function(a){var i,p,b={};if(a===""){return{};}
for(i=0;i<a.length;i+=1){p=a[i].split('=');if(p.length===2){b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," "));}}
return b;};$.queryParams=function(){return queryParser(window.location.search.substr(1).split('&'));};$.hashParams=function(){return queryParser(window.location.hash.substr(1).split('&'));};window.Swiftype=window.Swiftype||{};Swiftype.root_url=Swiftype.root_url||'https://api.swiftype.com';Swiftype.pingUrl=function(endpoint,callback){var to=setTimeout(callback,350);var img=new Image();img.onload=img.onerror=function(){clearTimeout(to);callback();};img.src=endpoint;return false;};Swiftype.pingSearchResultClick=function(engineKey,docId,callback){var params={t:new Date().getTime(),engine_key:engineKey,doc_id:docId,q:Swiftype.currentQuery};var url=Swiftype.root_url+'/api/v1/public/analytics/pc?'+$.param(params);Swiftype.pingUrl(url,callback);};$.fn.swiftypeSearch=function(options){var options=$.extend({},$.fn.swiftypeSearch.defaults,options);return this.each(function(){var $this=$(this);var config=$.meta?$.extend({},options,$this.data()):options;$this.data('swiftype-config-search',config);$this.selectedCallback=function(data){return function(e){var $el=$(this);e.preventDefault();Swiftype.pingSearchResultClick(config.engineKey,data['id'],function(){config.onComplete($el);});};};$this.registerResult=function($element,data){$element.data('swiftype-item',data);$('a',$element).click($this.selectedCallback(data));};$this.getContentCache=function(){return $('#'+contentCacheId);};var $resultContainer=$(config.resultContainingElement),initialContentOfResultContainer=$resultContainer.html(),contentCacheId='st-content-cache',$contentCache=$this.getContentCache();var setSearchHash=function(query,page){location.hash="stq="+encodeURIComponent(query)+"&stp="+page;};var submitSearch=function(query,options){options=$.extend({page:1},options);var params={};if(!$contentCache.length){$resultContainer.after("<div id='"+contentCacheId+"' style='display: none;'></div>");$contentCache.html(initialContentOfResultContainer).hide();}
config.loadingFunction(query,$resultContainer);Swiftype.currentQuery=query;params['q']=query;params['engine_key']=config.engineKey;params['page']=options.page;function handleFunctionParam(field){if(field!==undefined){var evald=field;if(typeof evald==='function'){evald=evald.call();}
return evald;}
return undefined;}
params['per_page']=handleFunctionParam(config.perPage);params['search_fields']=handleFunctionParam(config.searchFields);params['fetch_fields']=handleFunctionParam(config.fetchFields);params['facets']=handleFunctionParam(config.facets);params['filters']=handleFunctionParam(config.filters);params['document_types']=handleFunctionParam(config.documentTypes);params['functional_boosts']=handleFunctionParam(config.functionalBoosts);params['sort_field']=handleFunctionParam(config.sortField);params['sort_direction']=handleFunctionParam(config.sortDirection);params['spelling']=handleFunctionParam(config.spelling);params['highlight_fields']=handleFunctionParam(config.highlightFields);$.ajax({dataType:"json",url:Swiftype.root_url+"/api/v1/public/engines/search.json?callback=?",data:params,xhrFields:{withCredentials:true},success:renderSearchResults});};function handleHashchange(){var params=$.hashParams();if(params.stq){submitSearch(params.stq,{page:params.stp});}else{var $contentCache=$this.getContentCache();if($contentCache.length){$resultContainer.html($contentCache.html());$contentCache.remove();}}}
Swiftype.reloadResults=handleHashchange;$(window).on("hashchange",handleHashchange);var $containingForm=$this.parents('form');if($containingForm){$containingForm.bind('submit',function(e){e.preventDefault();var searchQuery=$this.val();setSearchHash(searchQuery,1);});}
$(document).on('click','[data-hash][data-page]',function(e){e.preventDefault();var $this=$(this);setSearchHash($.hashParams().stq,$this.data('page'));});$(document).on('click','[data-hash][data-spelling-suggestion]',function(e){e.preventDefault();var $this=$(this);setSearchHash($this.data('spelling-suggestion'),1);});var renderSearchResults=function(data){if(typeof config.preRenderFunction==='function'){config.preRenderFunction.call($this,data);}
config.renderResultsFunction($this.getContext(),data);if(typeof config.postRenderFunction==='function'){config.postRenderFunction.call($this,data);}};$this.getContext=function(){return{config:config,resultContainer:$resultContainer,registerResult:$this.registerResult};};handleHashchange();});};var renderPagination=function(ctx,resultInfo){var maxPagesType,maxPages=-1,config=ctx.config;$.each(resultInfo,function(documentType,typeInfo){if(typeInfo.num_pages>maxPages){maxPagesType=documentType;maxPages=typeInfo.num_pages;}});var currentPage=resultInfo[maxPagesType].current_page,totalPages=resultInfo[maxPagesType].num_pages;$(config.renderPaginationForType(maxPagesType,currentPage,totalPages)).appendTo(ctx.resultContainer);};var normalize=function(str){return $.trim(str).toLowerCase();};function htmlEscape(str){return String(str).replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/'/g,'&#39;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
var defaultRenderResultsFunction=function(ctx,data){var $resultContainer=ctx.resultContainer,config=ctx.config;$resultContainer.html('');$.each(data.records,function(documentType,items){$.each(items,function(idx,item){ctx.registerResult($(config.renderFunction(documentType,item)).appendTo($resultContainer),item);});});renderPagination(ctx,data.info);};var defaultRenderFunction=function(document_type,item){return '<div class="st-result"><h3 class="title"><a href="'+item['url']+'" class="st-search-result-link">'+htmlEscape(item['title'])+'</a></h3></div>';};var defaultLoadingFunction=function(query,$resultContainer){$resultContainer.html('<p class="st-loading-message">loading...</p>');};var defaultOnComplete=function(elem){window.location=elem.attr('href');};var defaultPostRenderFunction=function(data){var totalResultCount=0;var $resultContainer=this.getContext().resultContainer;var spellingSuggestion=null;if(data['info']){$.each(data['info'],function(index,value){totalResultCount+=value['total_result_count'];if(value['spelling_suggestion']){spellingSuggestion=value['spelling_suggestion']['text'];}});}
if(totalResultCount===0){$resultContainer.html("<div id='st-no-results' class='st-no-results'>No results found.</div>");}
if(spellingSuggestion!==null){$resultContainer.append('<div class="st-spelling-suggestion">Did you mean <a href="#" data-hash="true" data-spelling-suggestion="'+spellingSuggestion+'">'+spellingSuggestion+'</a>?</div>');}};var defaultRenderPaginationForType=function(type,currentPage,totalPages){var pages='<div class="st-page">',previousPage,nextPage;if(currentPage!=1){previousPage=currentPage-1;pages=pages+'<a href="#" class="st-prev" data-hash="true" data-page="'+previousPage+'">&laquo; previous</a>';}
if(currentPage<totalPages){nextPage=currentPage+1;pages=pages+'<a href="#" class="st-next" data-hash="true" data-page="'+nextPage+'">next &raquo;</a>';}
pages+='</div>';return pages;};$.fn.swiftypeSearch.defaults={attachTo:undefined,documentTypes:undefined,facets:undefined,filters:undefined,engineKey:undefined,searchFields:undefined,functionalBoosts:undefined,sortField:undefined,sortDirection:undefined,fetchFields:undefined,highlightFields:undefined,preRenderFunction:undefined,postRenderFunction:defaultPostRenderFunction,loadingFunction:defaultLoadingFunction,renderResultsFunction:defaultRenderResultsFunction,renderFunction:defaultRenderFunction,renderPaginationForType:defaultRenderPaginationForType,onComplete:defaultOnComplete,perPage:10,spelling:'strict'};})(jQuery);(function($){var queryParser=function(a){var i,p,b={};if(a===""){return{};}
for(i=0;i<a.length;i+=1){p=a[i].split('=');if(p.length===2){b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," "));}}
return b;};$.queryParams=function(){return queryParser(window.location.search.substr(1).split('&'));};$.hashParams=function(){return queryParser(window.location.hash.substr(1).split('&'));};var ident=0;window.Swiftype=window.Swiftype||{};Swiftype.root_url=Swiftype.root_url||'https://api.swiftype.com';Swiftype.pingUrl=function(endpoint,callback){var to=setTimeout(callback,350);var img=new Image();img.onload=img.onerror=function(){clearTimeout(to);callback();};img.src=endpoint;return false;};Swiftype.pingAutoSelection=function(engineKey,docId,value,callback){var params={t:new Date().getTime(),engine_key:engineKey,doc_id:docId,prefix:value};var url=Swiftype.root_url+'/api/v1/public/analytics/pas?'+$.param(params);Swiftype.pingUrl(url,callback);};Swiftype.findSelectedSection=function(){var sectionText=$.hashParams().sts;if(!sectionText){return;}
function normalizeText(str){var out=str.replace(/\s+/g,'');out=out.toLowerCase();return out;}
sectionText=normalizeText(sectionText);$('h1, h2, h3, h4, h5, h6').each(function(idx){$this=$(this);if(normalizeText($this.text()).indexOf(sectionText)>=0){this.scrollIntoView(true);return false;}});};Swiftype.htmlEscape=Swiftype.htmlEscape||function htmlEscape(str){return String(str).replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/'/g,'&#39;').replace(/</g,'&lt;').replace(/>/g,'&gt;');};$.fn.swiftype=function(options){Swiftype.findSelectedSection();var options=$.extend({},$.fn.swiftype.defaults,options);return this.each(function(){var $this=$(this);var config=$.meta?$.extend({},options,$this.data()):options;$this.attr('autocomplete','off');$this.data('swiftype-config-autocomplete',config);$this.submitted=false;$this.cache=new LRUCache(10);$this.emptyQueries=[];$this.isEmpty=function(query){return $.inArray(normalize(query),this.emptyQueries)>=0};$this.addEmpty=function(query){$this.emptyQueries.unshift(normalize(query));};var styles=config.dropdownStylesFunction($this);var $swiftypeWidget=$('<div class="'+config.widgetContainerClass+'" />');var $listContainer=$('<div />').addClass(config.suggestionListClass).appendTo($swiftypeWidget).css(styles).hide();$swiftypeWidget.appendTo(config.autocompleteContainingElement);var $list=$('<'+config.suggestionListType+' />').appendTo($listContainer);$this.data('swiftype-list',$list);$this.abortCurrent=function(){if($this.currentRequest){$this.currentRequest.abort();}};$this.showList=function(){if(handleFunctionParam(config.disableAutocomplete)===false){$listContainer.show();}};$this.hideList=function(sync){if(sync){$listContainer.hide();}else{setTimeout(function(){$listContainer.hide();},10);}};$this.showNoResults=function(){$list.empty();if(config.noResultsMessage===undefined){$this.hideList();}else{$list.append($('<li />',{'class':config.noResultsClass}).text(config.noResultsMessage));$this.showList();}};$this.focused=function(){return $this.is(':focus');};$this.submitting=function(){$this.submitted=true;};$this.listResults=function(){return $(config.resultListSelector,$list).filter(':not(.'+config.noResultsClass+')');};$this.activeResult=function(){return $this.listResults().filter('.'+config.activeItemClass).first();};$this.prevResult=function(){var list=$this.listResults(),currentIdx=list.index($this.activeResult()),nextIdx=currentIdx-1,next=list.eq(nextIdx);$this.listResults().removeClass(config.activeItemClass);if(nextIdx>=0){next.addClass(config.activeItemClass);}};$this.nextResult=function(){var list=$this.listResults(),currentIdx=list.index($this.activeResult()),nextIdx=currentIdx+1,next=list.eq(nextIdx);$this.listResults().removeClass(config.activeItemClass);if(nextIdx>=0){next.addClass(config.activeItemClass);}};$this.selectedCallback=function(data){return function(){var value=$this.val(),callback=function(){config.onComplete(data,value);};Swiftype.pingAutoSelection(config.engineKey,data['id'],value,callback);};};$this.registerResult=function($element,data){$element.data('swiftype-item',data);$element.click($this.selectedCallback(data)).mouseover(function(){$this.listResults().removeClass(config.activeItemClass);$element.addClass(config.activeItemClass);});};$this.getContext=function(){return{config:config,list:$list,registerResult:$this.registerResult};};Swiftype.resetAutocompleteCache=function(){if($this.cache){$this.cache=new LRUCache(10);$this.lastValue=null;processInput($this);}}
var typingDelayPointer;var suppressKey=false;$this.lastValue='';$this.keyup(function(event){if(suppressKey){suppressKey=false;return;}
if(((event.which>36)&&(event.which<41))||(event.which==16))return;if(config.typingDelay>0){clearTimeout(typingDelayPointer);typingDelayPointer=setTimeout(function(){processInput($this);},config.typingDelay);}else{processInput($this);}});$this.styleDropdown=function(){$listContainer.css(config.dropdownStylesFunction($this));};$(window).resize(function(event){$this.styleDropdown();});$this.keydown(function(event){$this.styleDropdown();var $active=$this.activeResult();switch(event.which){case 13:if(($active.length!==0)&&($list.is(':visible'))){event.preventDefault();$this.selectedCallback($active.data('swiftype-item'))();}else if($this.currentRequest){$this.submitting();}
$this.hideList();suppressKey=true;break;case 38:event.preventDefault();if($active.length===0){$this.listResults().last().addClass(config.activeItemClass);}else{$this.prevResult();}
break;case 40:event.preventDefault();if($active.length===0){$this.listResults().first().addClass(config.activeItemClass);}else if($active!=$this.listResults().last()){$this.nextResult();}
break;case 27:$this.hideList();suppressKey=true;break;default:$this.submitted=false;break;}});$this.keypress(function(event){if((event.which==13)&&($this.activeResult().length>0)){event.preventDefault();}});var mouseDown=false;var blurWait=false;$(document).bind('mousedown.swiftype'+ ++ident,function(){mouseDown=true;});$(document).bind('mouseup.swiftype'+ident,function(){mouseDown=false;if(blurWait){blurWait=false;$this.hideList();}});$this.blur(function(){if(mouseDown){blurWait=true;}else{$this.hideList();}});$this.focus(function(){setTimeout(function(){$this.select()},10);if($this.listResults().length>0){$this.showList();}});});};var normalize=function(str){return $.trim(str).toLowerCase();};var callRemote=function($this,term){$this.abortCurrent();var params={},config=$this.data('swiftype-config-autocomplete');params['q']=term;params['engine_key']=config.engineKey;params['search_fields']=handleFunctionParam(config.searchFields);params['fetch_fields']=handleFunctionParam(config.fetchFields);params['filters']=handleFunctionParam(config.filters);params['document_types']=handleFunctionParam(config.documentTypes);params['functional_boosts']=handleFunctionParam(config.functionalBoosts);params['sort_field']=handleFunctionParam(config.sortField);params['sort_direction']=handleFunctionParam(config.sortDirection);params['per_page']=config.resultLimit;params['highlight_fields']=config.highlightFields;var endpoint=Swiftype.root_url+'/api/v1/public/engines/suggest.json';$this.currentRequest=$.ajax({type:'GET',dataType:'jsonp',url:endpoint,data:params}).done(function(data){var norm=normalize(term);if(data.record_count>0){$this.cache.put(norm,data.records);}else{$this.addEmpty(norm);$this.showNoResults();return;}
processData($this,data.records,term);});};var getResults=function($this,term){var norm=normalize(term);if($this.isEmpty(norm)){$this.showNoResults();return;}
var cached=$this.cache.get(norm);if(cached){processData($this,cached,term);}else{callRemote($this,term);}};var processInput=function($this){var term=$this.val();if(term===$this.lastValue){return;}
$this.lastValue=term;if($.trim(term)===''){$this.data('swiftype-list').empty()
$this.hideList();return;}
if(typeof $this.data('swiftype-config-autocomplete').engineKey!=='undefined'){getResults($this,term);}};var processData=function($this,data,term){var $list=$this.data('swiftype-list'),config=$this.data('swiftype-config-autocomplete');$list.empty();$this.hideList(true);config.resultRenderFunction($this.getContext(),data,term);var totalItems=$this.listResults().length;if((totalItems>0&&$this.focused())||(config.noResultsMessage!==undefined)){if($this.submitted){$this.submitted=false;}else{$this.showList();}}};var defaultResultRenderFunction=function(ctx,results){var $list=ctx.list,config=ctx.config;$.each(results,function(document_type,items){$.each(items,function(idx,item){ctx.registerResult($('<li>'+config.renderFunction(document_type,item,idx)+'</li>').appendTo($list),item);});});};var defaultRenderFunction=function(document_type,item,idx){return '<p class="title">'+Swiftype.htmlEscape(item['title'])+'</p>';};var defaultOnComplete=function(item,prefix){window.location=item['url'];};var defaultDropdownStylesFunction=function($this){var config=$this.data('swiftype-config-autocomplete');var $attachEl=config.attachTo?$(config.attachTo):$this;var offset=$attachEl.offset();var styles={'position':'absolute','z-index':9999,'top':offset.top+$attachEl.outerHeight()+1,'left':offset.left};if(config.setWidth){styles['width']=$attachEl.outerWidth()-2;}
return styles;};var handleFunctionParam=function(field){if(field!==undefined){var evald=field;if(typeof evald==='function'){evald=evald.call();}
return evald;}
return undefined;};function LRUCache(limit){this.size=0;this.limit=limit;this._keymap={};}
LRUCache.prototype.put=function(key,value){var entry={key:key,value:value};this._keymap[key]=entry;if(this.tail){this.tail.newer=entry;entry.older=this.tail;}else{this.head=entry;}
this.tail=entry;if(this.size===this.limit){return this.shift();}else{this.size++;}};LRUCache.prototype.shift=function(){var entry=this.head;if(entry){if(this.head.newer){this.head=this.head.newer;this.head.older=undefined;}else{this.head=undefined;}
entry.newer=entry.older=undefined;delete this._keymap[entry.key];}
return entry;};LRUCache.prototype.get=function(key,returnEntry){var entry=this._keymap[key];if(entry===undefined)return;if(entry===this.tail){return entry.value;}
if(entry.newer){if(entry===this.head)this.head=entry.newer;entry.newer.older=entry.older;}
if(entry.older)entry.older.newer=entry.newer;entry.newer=undefined;entry.older=this.tail;if(this.tail)this.tail.newer=entry;this.tail=entry;return returnEntry?entry:entry.value;};LRUCache.prototype.remove=function(key){var entry=this._keymap[key];if(!entry)return;delete this._keymap[entry.key];if(entry.newer&&entry.older){entry.older.newer=entry.newer;entry.newer.older=entry.older;}else if(entry.newer){entry.newer.older=undefined;this.head=entry.newer;}else if(entry.older){entry.older.newer=undefined;this.tail=entry.older;}else{this.head=this.tail=undefined;}
this.size--;return entry.value;};LRUCache.prototype.clear=function(){this.head=this.tail=undefined;this.size=0;this._keymap={};};if(typeof Object.keys==='function'){LRUCache.prototype.keys=function(){return Object.keys(this._keymap);};}else{LRUCache.prototype.keys=function(){var keys=[];for(var k in this._keymap)keys.push(k);return keys;};}
$.fn.swiftype.defaults={activeItemClass:'active',attachTo:undefined,documentTypes:undefined,filters:undefined,engineKey:undefined,searchFields:undefined,functionalBoosts:undefined,sortField:undefined,sortDirection:undefined,fetchFields:undefined,highlightFields:undefined,noResultsClass:'noResults',noResultsMessage:undefined,onComplete:defaultOnComplete,resultRenderFunction:defaultResultRenderFunction,renderFunction:defaultRenderFunction,dropdownStylesFunction:defaultDropdownStylesFunction,resultLimit:undefined,suggestionListType:'ul',suggestionListClass:'autocomplete',resultListSelector:'li',setWidth:true,typingDelay:80,disableAutocomplete:false,autocompleteContainingElement:'body',widgetContainerClass:'swiftype-widget'};})(jQuery);